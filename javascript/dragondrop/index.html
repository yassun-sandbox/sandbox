<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title></title>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>
<body>

  <form action="#">
      <div id="drag-area" style="background-color: brown;">
        <p>アップロードするファイルをドロップ</p>
        <p>または</p>
        <div class="btn-group">
          <input type="file" multiple="multiple" style="display:none;">
          <button id="btn">ファイルを選択</button>
        </div>
      </div>
      <button type="submit">Submit</button>
  </form>

<script>
   $(document).ready(function(){

      /*================================================
        ファイルをドロップした時の処理
      =================================================*/
      $('#drag-area').bind('drop', function(e){

        // デフォルトの挙動を停止
        e.preventDefault();

        // ファイル情報を取得
        var files = e.originalEvent.dataTransfer.files;

        console.log(files);

        uploadFiles(files);

      }).bind('dragenter', function(){
        // デフォルトの挙動を停止
        return false;
      }).bind('dragover', function(){
        // デフォルトの挙動を停止
        return false;
      });

      /*================================================
        ダミーボタンを押した時の処理
      =================================================*/
      $('#btn').click(function() {
        // ダミーボタンとinput[type="file"]を連動
        $('input[type="file"]').click();
      });

      $('input[type="file"]').change(function(){
        // ファイル情報を取得
        var files = this.files;
        uploadFiles(files);
      });


    /*================================================
      アップロード処理
    =================================================*/
    function uploadFiles(files) {

      // FormDataオブジェクトを用意
      var fd = new FormData();

      // ファイルの個数を取得
      var filesLength = files.length;

      // ファイル情報を追加
      for (var i = 0; i < filesLength; i++) {
        fd.append("files[]", files[i]);
      }

      // Ajaxでアップロード処理をするファイルへ内容渡す
      $.ajax({
        url: '/hogehuga',
        type: 'POST',
        data: fd,
        processData: false,
        contentType: false,
        success: function(data) {
          console.log('ファイルがアップロードされました。');
        },
        error:function(data){
          alert('アップロード');
        }
      });

    };

   });

</script>

</body>
</html>


